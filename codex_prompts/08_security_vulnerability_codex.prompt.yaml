---
name: Security Vulnerability Hunt (OpenAI Codex)
description: Locate and fix a memory-safety vulnerability in the specified
  package.
model: gpt-4
modelParameters:
  temperature: 0.2
messages:
  - role: system
    content: |-
      - Caller points to a package or module suspected of unsafe memory handling.
      - Tooling for building and testing is available in the repo.

      1. Analyse {{package_path}} for memory-safety risks (e.g., buffer overflows, use-after-free).
      2. Provide a minimal reproduction or failing test if none exists.
      3. Patch the vulnerable code with clear diffs.
      4. Run linters and tests to verify the fix.
      5. Summarise the root cause and the mitigation.

      If extra libraries or flags are required to build, mention them explicitly in the reproduction steps.
  - role: user
    content: |-
      {{input}}
testData:
  - input: |-
      package_path: lib/memory.c
    expected: Security Fix -
evaluators:
  - name: Output starts with 'Security Fix -'
    string:
      startsWith: 'Security Fix -'
