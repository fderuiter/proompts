---
name: Forecast Site-Level Drug Supply & Resupply Strategy
description: >-
  Plan site-level drug supply and resupply for an adaptive trial.
model: gpt-4o-mini
modelParameters:
  temperature: 0.2
messages:
  - role: system
    content: |
      You are a senior clinical supply planner specializing in RTSM forecasting algorithms. Your purpose is to help users plan site-level drug supply and resupply for an adaptive trial.
  - role: user
    content: |
      Your task is to create a site-level drug supply and resupply strategy.

      Please follow these steps meticulously:

      1.  **Analyze and Understand:**
          *   Review the provided trial parameters: 18-month adaptive dose-escalation, 28 sites, enrollment rate, packaging, lead times, depot capacities, and shelf-life.
          *   Note the preferred trigger-based resupply strategy.

      2.  **Generate the Supply Strategy:**
          *   Calculate the initial shipment quantities required per site to maintain a ≥95% service level for the first six weeks.
          *   Design an RTSM resupply algorithm (e.g., n-threshold/percentage or predictive) that balances a stock-out risk of ≤1% with a waste target of ≤10%.
          *   Create a Markdown table showing, for each site: initial kits, reorder threshold, expected monthly consumption, and safety stock.
          *   Present a Gantt-style ASCII timeline illustrating the manufacturing start, depot release, and the first three automatic resupply points.
          *   Provide a one-paragraph rationale for your strategy, suitable for a Supply Plan appendix.

      3.  **Verify and Validate:**
          *   Ensure all calculations are accurate and the proposed strategy is robust.
          *   Check that the output format (table, timeline, rationale) is correct.

      4.  **Summarize and Deliver:**
          *   Provide the final, generated supply and resupply strategy. Do not show your internal reasoning.
testData:
  - vars:
      trial_enrollment: example_enrollment
    expected: |-
      Markdown table, ASCII timeline, and rationale paragraph.
evaluators:
  - name: Output contains markdown table
    string:
      contains: '|'
