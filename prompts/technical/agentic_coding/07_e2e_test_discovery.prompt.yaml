# yamllint disable rule:line-length
---
name: E2E Test Discovery Template
description: Provide a system prompt template that guides an LLM to analyse a codebase and generate a comprehensive end-to-end test plan.
model: gpt-4
modelParameters:
  temperature: 0.2
messages:
  - role: system
    content: |
      You are an expert AI coding agent. Your purpose is to help users by improving the test coverage of their codebase.
  - role: user
    content: |
      Your task is to add new tests to the codebase to improve test coverage.

      Please follow these steps meticulously:

      1.  **Analyze and Identify:**
          *   Scan the codebase to identify areas with low or no test coverage.
          *   Prioritize critical components or functions that lack adequate testing.
          *   Determine the types of tests that are needed (e.g., unit tests, integration tests).

      2.  **Implement the Change:**
          *   Write meaningful and robust tests for the identified areas.
          *   Ensure the new tests are well-structured and follow the existing testing framework and conventions.
          *   The tests should cover both success and failure scenarios (edge cases).

      3.  **Verify and Validate:**
          *   Run the newly created tests to ensure they pass and correctly test the intended functionality.
          *   Run the entire test suite to make sure you haven't accidentally broken any existing tests.

      4.  **Report or Summarize:**
          *   Provide a summary of the new tests you have added.
          *   Mention the files or modules you have improved the coverage for and confirm that all tests pass.
      Inputs:
      - `{{PROJECT_NAME}}` – project identifier
      - `{{LANGUAGES/FRAMEWORKS}}` – primary tech stack
      - `{{BUSINESS_GOAL}}` – high-level goal of the system
      Output format:
      Markdown report with sections:

      1. Repository Overview
      1. Critical User Journeys
      1. API / Interface Catalogue
      1. State & Data Requirements
      1. Non-Functional Requirements
      1. Edge Cases & Negative Paths
      1. Environment & Tooling
      1. Proposed E2E Test Suite
      1. Coverage Gaps & Risk Register
testData:
  - vars:
      LANGUAGES/FRAMEWORKS: example_LANGUAGES/FRAMEWORKS
      BUSINESS_GOAL: example_BUSINESS_GOAL
      PROJECT_NAME: example_PROJECT_NAME
    expected: |-
      Markdown report with sections:

      1. Repository Overview
      1. Critical User Journeys
      1. API / Interface Catalogue
      1. State & Data Requirements
      1. Non-Functional Requirements
      1. Edge Cases & Negative Paths
      1. Environment & Tooling
      1. Proposed E2E Test Suite
      1. Coverage Gaps & Risk Register
evaluators:
  - name: Output starts with 'Repository Overview'
    string:
      startsWith: 'Repository Overview'
