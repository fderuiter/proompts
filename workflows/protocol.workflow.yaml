name: "Protocol Workflow"
description: "A workflow to create, review, and refine a clinical trial protocol."

inputs:
  - name: "summary_sheet"
    description: "A one-page summary of the study to create the protocol."
  - name: "process_information"
    description: "Scope, audience, and regulatory context for the SOP."
  - name: "condition"
    description: "The disease or study condition for protocol section refinement."
  - name: "draft_section"
    description: "The current text of the protocol section to be refined."

steps:
  - step_id: "protocol_creator"
    prompt_file: "prompts/clinical/protocol/01_clinical_trial_protocol_creator.prompt.yaml"
    map_inputs:
      summary_sheet: "{{inputs.summary_sheet}}"

  - step_id: "sop_architect"
    prompt_file: "prompts/clinical/protocol/02_ultimate_sop_architect.prompt.yaml"
    map_inputs:
      process_information: "{{inputs.process_information}}"

  - step_id: "protocol_reviewer"
    prompt_file: "prompts/clinical/protocol/03_protocol_reviewer_gap_analysis_coach.prompt.yaml"
    map_inputs:
      protocol_text_or_nct: "{{steps.protocol_creator.output}}"

  - step_id: "protocol_refinement"
    prompt_file: "prompts/clinical/protocol/04_protocol_section_refinement.prompt.yaml"
    map_inputs:
      condition: "{{inputs.condition}}"
      draft_section: "{{inputs.draft_section}}"
